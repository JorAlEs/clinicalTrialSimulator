% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_longitudinal_outcomes.R
\name{simulate_longitudinal_outcomes}
\alias{simulate_longitudinal_outcomes}
\title{Simulate longitudinal outcome measurements}
\usage{
simulate_longitudinal_outcomes(
  visits,
  patients,
  baseline_mean = 0,
  baseline_sd = 1,
  control_slope = 0,
  treatment_slope = 0,
  error_sd = 1,
  cluster_var = NULL,
  cluster_effect_sd = 0
)
}
\arguments{
\item{visits}{A data frame of scheduled visits (e.g., output of \code{\link{simulate_visits}}) with at least \code{ID} and \code{Time} columns for each patient visit.}

\item{patients}{The patient data frame (as from \code{\link{simulate_patients}} and subsequent steps) that includes patient-level information such as treatment group and possibly site or country.}

\item{baseline_mean}{Numeric, the overall mean outcome at baseline for control patients (default = 0).}

\item{baseline_sd}{Numeric, standard deviation for baseline outcome between patients (default = 1).}

\item{control_slope}{Numeric, the rate of change in outcome over time for the control group (per unit time, default = 0 for no change).}

\item{treatment_slope}{Numeric, additional rate of change in outcome over time for the treatment group relative to control (per unit time, default = 0). For example, a negative value indicates the treatment groupâ€™s outcome improves (decreases) over time relative to control.}

\item{error_sd}{Numeric, standard deviation of measurement error or intra-patient variability at each visit (default = 1).}

\item{cluster_var}{Character, name of a clustering variable in \code{patients} (e.g., "Site" or "Country") for multi-level outcomes. If provided, random intercepts are simulated for each cluster (default = NULL).}

\item{cluster_effect_sd}{Numeric, standard deviation of the cluster-level random intercept (default = 0, meaning no cluster effect).}
}
\value{
A data frame with longitudinal measurements for each patient visit. Columns include:
\itemize{
  \item \code{ID}: Patient ID.
  \item \code{Time}: Visit time.
  \item \code{Arm}: Treatment group for that patient (from \code{patients$Arm}).
  \item \code{Site} (or \code{Country}): If those columns exist in \code{patients}, they are included here for reference.
  \item \code{Outcome}: Simulated outcome value at that visit time.
}
}
\description{
This function generates longitudinal (repeated measures) outcomes for patients at given visit times. It can incorporate treatment effects over time and between-patient variability, including a random site or country effect to simulate multi-level data.
}
\details{
The outcome for patient \emph{i} at time \emph{t} is simulated as:
\deqn{Outcome_{i}(t) = B_{i0} + (\beta_c + \beta_t * I(\text{treatment}_i)) * t + \epsilon_{i}(t),}
where \eqn{B_{i0}} is the baseline outcome for patient \emph{i} (including any cluster effect), \eqn{\beta_c} is the control group slope, \eqn{\beta_t} is the additional treatment effect on slope (so total slope for treatment = \eqn{\beta_c + \beta_t}), and \eqn{\epsilon_{i}(t)} is random measurement error with SD = \code{error_sd}. If \code{cluster_var} is specified, each cluster gets a random intercept added to \eqn{B_{i0}} (with SD = \code{cluster_effect_sd}), which introduces between-cluster variability (an original feature demonstrating multi-level data).

Baseline outcomes (\emph{t}=0) are generated from \code{N(baseline_mean + cluster\_offset, baseline_sd^2)} for each patient. Set \code{baseline_sd = 0} for identical baseline values within a cluster.
}
\examples{
df <- simulate_patients(2, countries = 1, sites_per_country = 2)
df$Arm <- factor(c("Control","Treatment"), levels = c("Control","Treatment"))
# Generate visits for baseline and time=10 for both patients
visits <- simulate_visits(df, visit_times = c(0, 10))
# Simulate longitudinal outcome (no error for clarity, treatment improves outcome)
visit_data <- simulate_longitudinal_outcomes(visits, df, baseline_mean = 100, baseline_sd = 0,
                                  control_slope = 0, treatment_slope = -5, error_sd = 0,
                                  cluster_var = "Site", cluster_effect_sd = 0)
visit_data  # Patient 1 (Control) stays at 100; Patient 2 (Treatment) drops to 50 by time 10

}
